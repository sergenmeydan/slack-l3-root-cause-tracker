{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "trigger": [
          "message"
        ],
        "channelId": {
          "__rl": true,
          "value": "Slack Ã¼zerindeki channelId'nizi giriniz.",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.slackTrigger",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "25565845-a65b-434e-a432-afa00039feb2",
      "name": "Slack Trigger",
      "webhookId": "WEBHOOK_URL/ID",
      "credentials": {
        "slackApi": {
          "id": "KENDI_CREDENTIAL_ID_NIZ",
          "name": "KENDI_SLACK_HESABINIZ."
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "language": "pythonNative",
        "pythonCode": "# Veriyi gÃ¼venli Ã§ek\ninput_data = _item\nraw_text = \"\"\n\n# Veriyi farklÄ± n8n sÃ¼rÃ¼mlerine gÃ¶re arÄ±yoruz\nif 'text' in input_data:\n    raw_text = input_data['text']\nelif 'json' in input_data and 'text' in input_data['json']:\n    raw_text = input_data['json']['text']\n\n# Metni temizleme\nclean_text = str(raw_text).strip()\nlower_text = clean_text.lower()\n\n# --- KESÄ°N BOT KÄ°LÄ°DÄ° ---\n# EÄŸer mesaj bir bot tarafÄ±ndan atÄ±lmÄ±ÅŸsa VEYA bizim rapor baÅŸlÄ±ÄŸÄ±mÄ±zÄ± iÃ§eriyorsa DUR\nif input_data.get('bot_id') or \"l3 teknik analiz raporu\" in lower_text:\n    # n8n'de bu adÄ±mÄ±n durmasÄ± iÃ§in boÅŸ dÃ¶nÃ¼yoruz\n    return None \n\n# VarsayÄ±lan deÄŸerler\nstructured_data = {\n    \"system_name\": \"Tespit Edilemedi\",\n    \"log_error\": clean_text if clean_text else \"Mesaj okunamadÄ±\",\n    \"root_cause\": \"Analiz Ediliyor\",\n    \"action_plan\": \"ğŸ” DetaylÄ± log incelemesi baÅŸlatÄ±lmalÄ±.\"\n}\n\n# --- AKILLI ANALÄ°Z VE AKSÄ°YON MANTIÄI ---\n\n# 1. VeritabanÄ± ve BaÄŸlantÄ± HatalarÄ±\nif any(x in lower_text for x in [\"database\", \"db\", \"connection\", \"baÄŸlantÄ±\", \"sql\"]):\n    structured_data[\"root_cause\"] = \"VeritabanÄ± EriÅŸim Sorunu\"\n    structured_data[\"action_plan\"] = \"ğŸ—„ï¸ VeritabanÄ± pool kapasitesini ve sunucu CPU yÃ¼kÃ¼nÃ¼ kontrol edin.\"\n\n# 2. Zaman AÅŸÄ±mÄ± ve Servis YanÄ±t HatalarÄ±\nelif any(x in lower_text for x in [\"timeout\", \"zaman aÅŸÄ±mÄ±\", \"yanÄ±t vermiyor\", \"slow\", \"yavaÅŸ\"]):\n    structured_data[\"root_cause\"] = \"Servis Performans Sorunu\"\n    structured_data[\"action_plan\"] = \"âš¡ Mikroservisi restart etmeyi ve aÄŸ gecikmesini kontrol etmeyi deneyin.\"\n\n# 3. Yetki ve EriÅŸim HatalarÄ±\nelif any(x in lower_text for x in [\"yetki\", \"auth\", \"permission\", \"403\", \"login\"]):\n    structured_data[\"root_cause\"] = \"EriÅŸim ve Yetki Sorunu\"\n    structured_data[\"action_plan\"] = \"ğŸ”‘ API Token geÃ§erliliÄŸini ve kullanÄ±cÄ± rollerini kontrol edin.\"\n\n# 4. Sistem Belirleme (Ekibinin kullandÄ±ÄŸÄ± sistemleri buraya ekle)\nsystems = [\"erp\", \"crm\", \"Ã¶deme\", \"sepet\", \"mobil\", \"web\"]\nfor s in systems:\n    if s in lower_text:\n        structured_data[\"system_name\"] = s.upper()\n\nreturn structured_data"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        432,
        0
      ],
      "id": "ebd378aa-2915-4453-a9bc-bc47b95d7bdf",
      "name": "Code in Python"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "YENI_KANAL_ID_BURAYA",
          "mode": "id"
        },
        "text": "=ğŸ¤– L3 Teknik Analiz Raporu ğŸ¢ Tahmin Edilen Sistem: {{ $json.system_name }} ğŸ’¡ KÃ¶k Neden: {{ $json.root_cause }} âœ… Ã–nerilen Aksiyon: {{ $json.action_plan }} ğŸ“ Gelen Mesaj: {{ $json.log_error }}",
        "otherOptions": {
          "thread_ts": {
            "replyValues": {
              "thread_ts": "={{ $('Slack Trigger').item.json.ts }}"
            }
          }
        }
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.4,
      "position": [
        640,
        0
      ],
      "id": "904dc9e8-de30-48a2-b86b-a5f758eb8b53",
      "name": "Send a message",
      "webhookId": "WEBHOOK_URL/ID",
      "credentials": {
        "slackApi": {
          "id": "Slack api id'nizi giriniz.",
          "name": "Slack hesabÄ±nÄ±z."
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "2d78590b-8bb8-43a2-a135-c361e2fc57dd",
              "leftValue": "={{ $('Slack Trigger').item.json.text }}",
              "rightValue": "hata",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "12ef9139-5baf-4af0-8d60-d70f0ae9a144",
              "leftValue": "={{ $('Slack Trigger').item.json.text }}",
              "rightValue": "problem",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "feb01291-b48c-4b1e-a0a2-4f71f41416fe",
              "leftValue": "={{ $('Slack Trigger').item.json.text }}",
              "rightValue": "yavaÅŸ",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "8af0f85a-68be-49ae-8648-92a9b1fdd2cd",
              "leftValue": "={{ $('Slack Trigger').item.json.text }}",
              "rightValue": "bug",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.3,
      "position": [
        208,
        0
      ],
      "id": "c1c446ad-5940-4240-bc3c-154a76e98f87",
      "name": "Filter"
    }
  ],
  "pinData": {},
  "connections": {
    "Slack Trigger": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in Python": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        []
      ]
    },
    "Filter": {
      "main": [
        [
          {
            "node": "Code in Python",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "***",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "Kendi id'nizi giriniz."
  },
  "id": "***",
  "tags": []
}